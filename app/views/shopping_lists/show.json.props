json.header do
  json.title "Family Shopping List"
end

json.items(partial: ["item_list", fragment: "shopping_list"]) do
end

# Set up streaming subscription
json.streamFromShopping stream_from_props("shopping")

json.totalCost(defer: [:auto, placeholder: { amount: "Calculating...", message: "Getting current prices" }]) do
  # Simulate expensive API call to get current prices
  sleep 0.2
  json.amount "$#{(10 + (rand() * 30)).round(2)}"
  json.message "Estimated total based on current prices"
end

json.newItemForm do
  form_props(model: Item.new, url: items_path) do |f|
    f.text_field :name, placeholder: "Add item..."
    f.submit "Add"
  end
end
