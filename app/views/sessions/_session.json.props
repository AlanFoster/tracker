json.id session.id
json.title session.title
json.description session.description
json.createdAt session.created_at
json.summary do
  ascent_counts = session.ascents.group(:color).count
  ascent_counts_sorted = Ascent.colors.filter_map do |color, _ordinal|
    next unless ascent_counts[color]

    [color, ascent_counts[color]]
  end
  json.ascentCounts do
    json.array! ascent_counts_sorted do |(color, count)|
      json.title "#{color.titleize} ascents"
      json.color color
      json.value count
    end
  end
end

json.ascents do
  json.array! session.ascents do |ascent|
    json.id ascent.id
    json.color ascent.color
    json.tries ascent.tries
    json.createdAt ascent.created_at
    json.editPath ascent.id ? edit_session_ascent_path(session, ascent) : nil
  end
end

json.deleteForm do
  form_props(url: session_path(session), method: :delete) do |f|
    f.submit 'remove'
  end
end
json.newAscentPath new_session_ascent_path(session.id)
json.detailPath session_path(session.id)
